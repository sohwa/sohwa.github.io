<!DOCTYPE html>
<head>
    <meta charset="UTF-8"/>
    <style>
    html, body { 
        padding:        0;
        margin:         0;
        width:          100%;
        height:         100%;
        overflow-x:     hidden;
        background-color: black;
    }
    </style>
</head>
<body oncontextmenu="return false" ondragstart="return false" onselectstart="return false"
        oncopy="return false" oncut="return false" onpaste="return false" >

    <div id="map" style="width:100%; height:100%; " ></div>
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=1cb02721f958616d7e3beee427b8e90c&libraries=services"></script>

    <script>
        var container = document.getElementById('map'); //지도를 담을 영역의 DOM 레퍼런스
        var options = { //지도를 생성할 때 필요한 기본 옵션
            center: new daum.maps.LatLng(33.450701, 126.570667), //지도의 중심좌표.
            level: 3 //지도의 레벨(확대, 축소 정도)
        };

        var map = new daum.maps.Map(container, options); //지도 생성 및 객체 리턴
        var geocoder = new daum.maps.services.Geocoder();
		var markers = [];

		// 마커를 생성하고 지도위에 표시하는 함수입니다
		function addMarker(position) {
			
			// 마커를 생성합니다
			var marker = new daum.maps.Marker({
				position: position
			});

			// 마커가 지도 위에 표시되도록 설정합니다
			marker.setMap(map);
			
			// 생성된 마커를 배열에 추가합니다
			markers.push(marker);
		}

		function deleteAllMarkers(){
			for(var i in markers){
			   markers[i].setMap(null);
			}

			markers = [];
		}

        daum.maps.event.addListener(map, 'click', function(mouseEvent) {        
            
    		var latlng = mouseEvent.latLng; 
            
			searchDetailAddrFromCoords(mouseEvent.latLng, function(result, status) {
				if (status === daum.maps.services.Status.OK) {

					var detailAddr = !!result[0].road_address ? '도로명주소 : ' + result[0].road_address.address_name  : '';
					detailAddr += ('  지번 주소 : ' + result[0].address.address_name );
					
					var local_url = (location.href).replace(/#.+/, "");
					var url = local_url + "#" + detailAddr;
					document.location.href = url;

					// 마커를 클릭한 위치에 표시합니다 
					deleteAllMarkers();
					addMarker(mouseEvent.latLng);

					// 지도 중심을 부드럽게 이동시킵니다
					// 만약 이동할 거리가 지도 화면보다 크면 부드러운 효과 없이 이동합니다
					map.panTo(latlng); 

				}   
			});
            
        });

		function searchAddrFromCoords(coords, callback) {
			// 좌표로 행정동 주소 정보를 요청합니다
			geocoder.coord2RegionCode(coords.getLng(), coords.getLat(), callback);         
		}

		function searchDetailAddrFromCoords(coords, callback) {
			// 좌표로 법정동 상세 주소 정보를 요청합니다
			geocoder.coord2Address(coords.getLng(), coords.getLat(), callback);
		}

        var searchAdd = function(address){
			geocoder.addressSearch(address, function(result, status) {

				 if (status === daum.maps.services.Status.OK) {

					var coords = new daum.maps.LatLng(result[0].y, result[0].x);

					deleteAllMarkers();
					addMarker(coords);

					map.setCenter(coords);
				} 
			}); 
        }


    </script>

</body>
